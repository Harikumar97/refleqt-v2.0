<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research Swarms - Refleqt Portal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #2d3748;
            line-height: 1.6;
        }

        .main-content {
            padding: 30px;
            min-height: 100vh;
        }

        /* Sub-Navigation */
        .sub-navigation {
            background: white;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .sub-nav-header {
            padding: 16px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            cursor: pointer;
            display: flex;
            justify-content: between;
            align-items: center;
            user-select: none;
        }

        .sub-nav-title {
            font-size: 16px;
            font-weight: 600;
            flex: 1;
        }

        .sub-nav-toggle {
            font-size: 18px;
            transition: transform 0.3s ease;
        }

        .sub-nav-toggle.collapsed {
            transform: rotate(-90deg);
        }

        .sub-nav-content {
            max-height: 200px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .sub-nav-content.collapsed {
            max-height: 0;
        }

        .sub-nav-tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            border-bottom: 1px solid #e2e8f0;
        }

        .sub-nav-tab {
            padding: 12px 16px;
            text-align: center;
            cursor: pointer;
            border-right: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            font-size: 13px;
            font-weight: 500;
            color: #4a5568;
        }

        .sub-nav-tab:last-child {
            border-right: none;
        }

        .sub-nav-tab:hover {
            background: #f7fafc;
            color: #667eea;
        }

        .sub-nav-tab.active {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        /* Header */
        .swarms-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .swarms-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 100%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 2px, transparent 2px);
            background-size: 20px 20px;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }

        .swarms-title {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
        }

        .swarms-subtitle {
            font-size: 16px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        /* Content Area */
        .content-area {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            min-height: 600px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* Dashboard Section */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .swarm-creator {
            background: #f7fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .creator-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #2d3748;
        }

        .query-input {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 14px;
            margin-bottom: 16px;
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .query-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .swarm-types-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .swarm-type-btn {
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 13px;
        }

        .swarm-type-btn:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.02);
        }

        .swarm-type-btn.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            font-weight: 600;
        }

        .launch-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .launch-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .launch-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Active Swarms */
        .active-swarms {
            max-height: 400px;
            overflow-y: auto;
        }

        .swarms-list-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .swarm-item {
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .swarm-item:hover {
            border-color: #667eea;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .swarm-query {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2d3748;
            font-size: 14px;
        }

        .swarm-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 12px;
            color: #718096;
            margin-bottom: 8px;
        }

        .status-badge {
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-badge.running {
            background: #fed7d7;
            color: #c53030;
        }

        .status-badge.completed {
            background: #c6f6d5;
            color: #2f855a;
        }

        .status-badge.processing {
            background: #fbd38d;
            color: #c05621;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #f1f5f9;
            border-radius: 2px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            background: #667eea;
            border-radius: 2px;
            transition: width 0.5s ease;
        }

        /* Stats Panel */
        .stats-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .stats-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            padding: 16px;
        }

        .stats-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #2d3748;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .stat-item {
            text-align: center;
            padding: 10px;
            background: #f7fafc;
            border-radius: 6px;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #2d3748;
        }

        .stat-label {
            font-size: 10px;
            color: #718096;
            text-transform: uppercase;
        }

        /* Templates Section */
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .template-card {
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .template-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .template-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .template-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2d3748;
        }

        .template-desc {
            font-size: 14px;
            color: #718096;
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .template-example {
            font-size: 12px;
            color: #4a5568;
            background: #f7fafc;
            padding: 8px;
            border-radius: 6px;
            font-style: italic;
        }

        /* Archive Section */
        .archive-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
        }

        .filter-btn:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.02);
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .search-box {
            width: 100%;
            max-width: 400px;
            padding: 10px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            font-size: 14px;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 16px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            color: #2d3748;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #718096;
        }

        .results-section {
            margin-bottom: 24px;
        }

        .results-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #2d3748;
        }

        .finding-item {
            padding: 12px;
            border-left: 4px solid #48bb78;
            background: #f0fff4;
            border-radius: 0 8px 8px 0;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .recommendation-item {
            padding: 16px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 12px;
        }

        .rec-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .rec-title {
            font-weight: 600;
            color: #2d3748;
            margin: 0;
        }

        .priority-tag {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .priority-high {
            background: #fed7d7;
            color: #c53030;
        }

        .priority-medium {
            background: #fbd38d;
            color: #c05621;
        }

        .priority-low {
            background: #c6f6d5;
            color: #2f855a;
        }

        .rec-impact {
            font-size: 14px;
            color: #4a5568;
            margin-bottom: 8px;
        }

        .rec-meta {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: #718096;
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #1f2937;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 500;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 4000;
            max-width: 300px;
            font-size: 13px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background: #10b981;
        }

        .toast.warning {
            background: #f59e0b;
        }

        .toast.error {
            background: #ef4444;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .sub-nav-tabs {
                grid-template-columns: repeat(2, 1fr);
            }

            .swarm-types-grid {
                grid-template-columns: 1fr;
            }

            .templates-grid {
                grid-template-columns: 1fr;
            }

            .archive-filters {
                flex-direction: column;
            }

            .search-box {
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="main-content">
        <!-- Sub-Navigation -->
        <div class="sub-navigation">
            <div class="sub-nav-header" onclick="toggleSubNav()">
                <div class="sub-nav-title">🔬 Research Swarms Navigation</div>
                <div class="sub-nav-toggle" id="sub-nav-toggle">▼</div>
            </div>
            <div class="sub-nav-content" id="sub-nav-content">
                <div class="sub-nav-tabs">
                    <div class="sub-nav-tab active" onclick="switchSection('dashboard')" data-section="dashboard">
                        🚀 Active Dashboard
                    </div>
                    <div class="sub-nav-tab" onclick="switchSection('templates')" data-section="templates">
                        📋 Swarm Templates
                    </div>
                    <div class="sub-nav-tab" onclick="switchSection('archive')" data-section="archive">
                        📚 Results Archive
                    </div>
                    <div class="sub-nav-tab" onclick="switchSection('competitive')" data-section="competitive">
                        🎯 Competitive Intel
                    </div>
                    <div class="sub-nav-tab" onclick="switchSection('trends')" data-section="trends">
                        📈 Market Trends
                    </div>
                    <div class="sub-nav-tab" onclick="switchSection('settings')" data-section="settings">
                        ⚙️ Configuration
                    </div>
                </div>
            </div>
        </div>

        <!-- Header -->
        <div class="swarms-header">
            <h1 class="swarms-title">🔬 Research Swarms Intelligence</h1>
            <p class="swarms-subtitle" id="header-subtitle">
                AI-powered multi-agent research system for deep competitive intelligence and market analysis
            </p>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Dashboard Section -->
            <div class="section active" id="dashboard-section">
                <div class="dashboard-grid">
                    <div>
                        <!-- Swarm Creator -->
                        <div class="swarm-creator">
                            <h2 class="creator-title">🚀 Launch New Research Swarm</h2>
                            <textarea 
                                class="query-input" 
                                id="swarm-query"
                                placeholder="What would you like the swarm to research? Be specific about your business challenge..."
                            ></textarea>
                            
                            <div class="swarm-types-grid">
                                <div class="swarm-type-btn selected" onclick="selectSwarmType('competitive')" data-type="competitive">
                                    🎯 Competitive Analysis
                                </div>
                                <div class="swarm-type-btn" onclick="selectSwarmType('market')" data-type="market">
                                    📈 Market Research
                                </div>
                                <div class="swarm-type-btn" onclick="selectSwarmType('customer')" data-type="customer">
                                    👥 Customer Intelligence
                                </div>
                                <div class="swarm-type-btn" onclick="selectSwarmType('product')" data-type="product">
                                    🔍 Product Research
                                </div>
                            </div>
                            
                            <button class="launch-btn" onclick="launchSwarm()" id="launch-btn" disabled>
                                🚀 Launch Swarm (Competitive Analysis)
                            </button>
                        </div>

                        <!-- Active Swarms -->
                        <div class="active-swarms">
                            <h2 class="swarms-list-title">⚡ Active Research Swarms</h2>
                            <div id="swarms-list">
                                <!-- Swarms will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Stats Panel -->
                    <div class="stats-panel">
                        <div class="stats-card">
                            <h3 class="stats-title">📊 Performance Metrics</h3>
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-value" id="total-swarms">47</div>
                                    <div class="stat-label">Total Swarms</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="active-swarms">3</div>
                                    <div class="stat-label">Active Now</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">2.3m</div>
                                    <div class="stat-label">Avg Time</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">94%</div>
                                    <div class="stat-label">Success Rate</div>
                                </div>
                            </div>
                        </div>

                        <div class="stats-card">
                            <h3 class="stats-title">💡 Recent Insights</h3>
                            <div class="finding-item">Competitors increasing AI feature mentions by 340%</div>
                            <div class="finding-item">Project management market growing 12% annually</div>
                            <div class="finding-item">Mobile-first features becoming customer requirement</div>
                        </div>

                        <div class="stats-card">
                            <h3 class="stats-title">🔥 Trending Queries</h3>
                            <div style="font-size: 12px; color: #4a5568; line-height: 1.4;">
                                <div style="margin-bottom: 6px;">• SaaS pricing strategy analysis</div>
                                <div style="margin-bottom: 6px;">• AI feature competitive landscape</div>
                                <div style="margin-bottom: 6px;">• Customer churn prediction models</div>
                                <div style="margin-bottom: 6px;">• Remote work tool integrations</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Templates Section -->
            <div class="section" id="templates-section">
                <h2 style="margin-bottom: 20px; color: #2d3748;">📋 Pre-built Swarm Templates</h2>
                <p style="margin-bottom: 30px; color: #718096;">Launch research swarms instantly with these industry-tested templates</p>
                
                <div class="templates-grid" id="templates-grid">
                    <!-- Templates will be populated here -->
                </div>
            </div>

            <!-- Archive Section -->
            <div class="section" id="archive-section">
                <h2 style="margin-bottom: 20px; color: #2d3748;">📚 Research Archive</h2>
                
                <div class="archive-filters">
                    <input type="text" class="search-box" placeholder="Search research history..." onkeyup="filterArchive()">
                    <div class="filter-btn active" onclick="setArchiveFilter('all')">All Results</div>
                    <div class="filter-btn" onclick="setArchiveFilter('competitive')">Competitive</div>
                    <div class="filter-btn" onclick="setArchiveFilter('market')">Market Research</div>
                    <div class="filter-btn" onclick="setArchiveFilter('customer')">Customer Intel</div>
                    <div class="filter-btn" onclick="setArchiveFilter('product')">Product Research</div>
                </div>
                
                <div id="archive-results">
                    <!-- Archive results will be populated here -->
                </div>
            </div>

            <!-- Competitive Intelligence Section -->
            <div class="section" id="competitive-section">
                <h2 style="margin-bottom: 20px; color: #2d3748;">🎯 Competitive Intelligence Dashboard</h2>
                <p style="margin-bottom: 30px; color: #718096;">Real-time monitoring and analysis of your competitive landscape</p>
                
                <div id="competitive-content">
                    <!-- Competitive intelligence content will be populated here -->
                </div>
            </div>

            <!-- Market Trends Section -->
            <div class="section" id="trends-section">
                <h2 style="margin-bottom: 20px; color: #2d3748;">📈 Market Trends Analysis</h2>
                <p style="margin-bottom: 30px; color: #718096;">Industry trends, forecasts, and opportunity identification</p>
                
                <div id="trends-content">
                    <!-- Market trends content will be populated here -->
                </div>
            </div>

            <!-- Settings Section -->
            <div class="section" id="settings-section">
                <h2 style="margin-bottom: 20px; color: #2d3748;">⚙️ Swarm Configuration</h2>
                <p style="margin-bottom: 30px; color: #718096;">Configure data sources, parameters, and notification preferences</p>
                
                <div id="settings-content">
                    <!-- Settings content will be populated here -->
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal-overlay" id="results-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="modal-title">Swarm Results</h2>
                    <button class="modal-close" onclick="closeModal()">×</button>
                </div>
                <div id="modal-body">
                    <!-- Modal content will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let activeSwarms = [
            {
                id: 1,
                query: "How are my competitors positioning against sustainable packaging trends?",
                type: "competitive",
                typeName: "Competitive Analysis",
                status: "completed",
                progress: 100,
                timeRemaining: null,
                timestamp: Date.now() - 3600000,
                results: {
                    keyFindings: [
                        "3 major competitors launched eco-friendly packaging lines in Q4 2024",
                        "Notion increased sustainability messaging by 340% across social channels", 
                        "Airtable partnered with TerraCycle for office waste management program",
                        "Market sentiment shows 73% positive response to sustainability initiatives",
                        "B2B customers increasingly requesting sustainability certifications in RFPs"
                    ],
                    recommendations: [
                        {
                            action: "Launch 'Green TaskFlow' sustainability initiative with carbon-neutral hosting",
                            impact: "Estimated 25% increase in eco-conscious customer segment acquisition",
                            priority: "High",
                            timeline: "2-3 months",
                            effort: "Medium",
                            revenue_impact: "$150K ARR potential"
                        },
                        {
                            action: "Partner with sustainable tech influencers and B-Corp certification",
                            impact: "Reach 150K+ sustainability-focused professionals, improve brand positioning",
                            priority: "Medium", 
                            timeline: "1 month",
                            effort: "Low",
                            revenue_impact: "$50K ARR potential"
                        },
                        {
                            action: "Develop sustainability dashboard feature for customer carbon tracking",
                            impact: "New premium feature differentiator, 40% of enterprise prospects interested",
                            priority: "High",
                            timeline: "4-6 months",
                            effort: "High",
                            revenue_impact: "$300K ARR potential"
                        }
                    ],
                    sources: [
                        "Competitor websites and press releases (47 sources analyzed)",
                        "Social media content analysis (12K posts across LinkedIn, Twitter)",
                        "Sustainability industry reports (McKinsey, BCG, Deloitte studies)",
                        "Customer review sentiment analysis (2,400 reviews processed)",
                        "RFP database analysis (340 enterprise RFPs from last 6 months)"
                    ]
                }
            },
            {
                id: 2,
                query: "What project management features are users requesting most in 2024?",
                type: "market",
                typeName: "Market Research",
                status: "processing",
                progress: 73,
                timeRemaining: "2 min",
                timestamp: Date.now() - 900000
            },
            {
                id: 3,
                query: "Analyze pricing strategies of top 5 SaaS competitors including recent changes",
                type: "competitive",
                typeName: "Competitive Analysis", 
                status: "running",
                progress: 45,
                timeRemaining: "4 min",
                timestamp: Date.now() - 300000
            }
        ];

        let selectedSwarmType = 'competitive';
        let obsessionScore = 8.4;
        let subNavCollapsed = false;

        // Templates data
        const swarmTemplates = [
            {
                icon: "🎯",
                title: "Competitor Feature Gap Analysis",
                description: "Identify missing features in competitor products that could be your competitive advantage",
                example: "Analyze Notion, Airtable, and Monday.com feature sets vs TaskFlow capabilities",
                query: "Compare TaskFlow features against Notion, Airtable, Monday.com, and Asana. Identify gaps in their offerings that we could exploit as competitive advantages. Focus on missing integrations, workflow limitations, and user complaints.",
                type: "competitive"
            },
            {
                icon: "💰",
                title: "SaaS Pricing Strategy Intelligence",
                description: "Monitor competitor pricing changes and market positioning strategies",
                example: "Track pricing updates across major project management tools",
                query: "Analyze current pricing strategies of Asana, Monday.com, Notion, Airtable, and Clickup. Track recent price changes, feature tier adjustments, and customer reactions. Provide recommendations for TaskFlow pricing optimization.",
                type: "competitive"
            },
            {
                icon: "📈",
                title: "Market Opportunity Mapping",
                description: "Discover emerging market segments and untapped customer needs",
                example: "Identify growing industries adopting project management tools",
                query: "Research fastest-growing industry segments adopting project management software in 2024-2025. Analyze their specific needs, budget ranges, and preferred feature sets. Identify underserved niches TaskFlow could target.",
                type: "market"
            },
            {
                icon: "👥",
                title: "Customer Churn Analysis",
                description: "Understand why customers leave for competitors and how to prevent it",
                example: "Analyze TaskFlow vs competitor customer satisfaction patterns",
                query: "Research why SaaS customers churn from project management tools. Analyze competitor customer reviews, complaints, and migration patterns. Identify early warning signs and retention strategies that work.",
                type: "customer"
            },
            {
                icon: "🤖",
                title: "AI Feature Competitive Landscape",
                description: "Track AI integration strategies across the competitive landscape",
                example: "Monitor AI features being launched by major PM tools",
                query: "Analyze AI features being integrated into project management tools by competitors. Track implementation approaches, customer reception, pricing models for AI features, and identify opportunities for TaskFlow's AI strategy.",
                type: "product"
            },
            {
                icon: "🔗",
                title: "Integration Ecosystem Analysis",
                description: "Map competitor integration strategies and identify partnership gaps",
                example: "Research Slack, Zoom, Google Workspace integration patterns",
                query: "Research integration ecosystems of major project management competitors. Analyze partnership strategies, API usage patterns, and integration gaps that TaskFlow could fill to gain competitive advantage.",
                type: "product"
            },
            {
                icon: "🌍",
                title: "Global Market Expansion Intelligence",
                description: "Research international market opportunities and localization requirements",
                example: "Analyze European and Asian market entry strategies",
                query: "Research international expansion strategies of successful SaaS project management tools. Analyze market entry approaches, localization requirements, pricing strategies, and regulatory considerations for key markets.",
                type: "market"
            },
            {
                icon: "📊",
                title: "Customer Segment Deep Dive",
                description: "Analyze specific customer segments and their unique requirements",
                example: "Research startup vs enterprise customer behavior patterns",
                query: "Deep dive into different customer segments using project management tools. Compare needs, behaviors, and satisfaction patterns between startups, SMBs, and enterprises. Identify segment-specific opportunities.",
                type: "customer"
            }
        ];

        // Utility functions
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast show ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);

            // Send to parent portal
            if (window.parent && window.parent !== window) {
                try {
                    window.parent.postMessage({
                        type: 'notification',
                        message: message,
                        notificationType: type
                    }, '*');
                } catch (e) {
                    console.log('Could not send notification to parent:', e);
                }
            }
        }

        function updateObsessionScore(increase, action) {
            obsessionScore = Math.min(10, obsessionScore + increase);
            showToast(`${action} completed! Obsession score increased by ${increase.toFixed(1)}`, 'success');
            
            // Send to parent portal
            if (window.parent && window.parent !== window) {
                try {
                    window.parent.postMessage({
                        type: 'refleqt-event',
                        event: 'obsession_updated',
                        data: {
                            newScore: obsessionScore,
                            action: action,
                            increase: increase
                        }
                    }, '*');
                } catch (e) {
                    console.log('Could not send obsession update to parent:', e);
                }
            }
        }

        // Sub-navigation functions
        function toggleSubNav() {
            const content = document.getElementById('sub-nav-content');
            const toggle = document.getElementById('sub-nav-toggle');
            
            subNavCollapsed = !subNavCollapsed;
            
            if (subNavCollapsed) {
                content.classList.add('collapsed');
                toggle.classList.add('collapsed');
            } else {
                content.classList.remove('collapsed');
                toggle.classList.remove('collapsed');
            }
        }

        function switchSection(sectionName) {
            // Update active tab
            document.querySelectorAll('.sub-nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-section="${sectionName}"]`).classList.add('active');
            
            // Update active section
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(`${sectionName}-section`).classList.add('active');
            
            // Update header subtitle based on section
            const subtitles = {
                dashboard: "AI-powered multi-agent research system for deep competitive intelligence and market analysis",
                templates: "Pre-built research templates for common business intelligence scenarios",
                archive: "Historical research results with search and filtering capabilities",
                competitive: "Real-time competitive intelligence and monitoring dashboard",
                trends: "Market trends analysis and opportunity identification system",
                settings: "Configuration and customization options for research swarms"
            };
            
            document.getElementById('header-subtitle').textContent = subtitles[sectionName];
            
            // Initialize section content if needed
            initializeSection(sectionName);
            
            showToast(`Switched to ${sectionName.charAt(0).toUpperCase() + sectionName.slice(1)} section`, 'info');
        }

        function initializeSection(sectionName) {
            switch(sectionName) {
                case 'templates':
                    populateTemplates();
                    break;
                case 'archive':
                    populateArchive();
                    break;
                case 'competitive':
                    populateCompetitive();
                    break;
                case 'trends':
                    populateTrends();
                    break;
                case 'settings':
                    populateSettings();
                    break;
            }
        }

        // Swarm management functions
        function selectSwarmType(type) {
            selectedSwarmType = type;
            
            // Update button states
            document.querySelectorAll('.swarm-type-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`[data-type="${type}"]`).classList.add('selected');
            
            // Update launch button text
            const typeNames = {
                competitive: 'Competitive Analysis',
                market: 'Market Research',
                customer: 'Customer Intelligence',
                product: 'Product Research'
            };
            
            document.getElementById('launch-btn').textContent = `🚀 Launch Swarm (${typeNames[type]})`;
        }

        function launchSwarm() {
            const query = document.getElementById('swarm-query').value.trim();
            if (!query) return;
            
            const typeNames = {
                competitive: 'Competitive Analysis',
                market: 'Market Research',
                customer: 'Customer Intelligence',
                product: 'Product Research'
            };
            
            const newSwarm = {
                id: activeSwarms.length + 1,
                query: query,
                type: selectedSwarmType,
                typeName: typeNames[selectedSwarmType],
                status: 'running',
                progress: 0,
                timeRemaining: '5 min',
                timestamp: Date.now()
            };
            
            activeSwarms.unshift(newSwarm);
            document.getElementById('swarm-query').value = '';
            updateLaunchButton();
            renderSwarms();
            updateStats();
            
            updateObsessionScore(0.3, 'Research Swarm Launched');
            showToast(`Research swarm launched: ${typeNames[selectedSwarmType]}`, 'success');
            
            // Simulate progress
            simulateSwarmProgress(newSwarm.id);
        }

        function simulateSwarmProgress(swarmId) {
            const interval = setInterval(() => {
                const swarmIndex = activeSwarms.findIndex(s => s.id === swarmId);
                if (swarmIndex === -1) {
                    clearInterval(interval);
                    return;
                }
                
                const swarm = activeSwarms[swarmIndex];
                if (swarm.status !== 'running' && swarm.status !== 'processing') {
                    clearInterval(interval);
                    return;
                }
                
                swarm.progress = Math.min(swarm.progress + Math.random() * 12, 100);
                
                if (swarm.progress > 50 && swarm.status === 'running') {
                    swarm.status = 'processing';
                    swarm.timeRemaining = '2 min';
                } else if (swarm.progress >= 95) {
                    swarm.status = 'completed';
                    swarm.timeRemaining = null;
                    swarm.progress = 100;
                    updateObsessionScore(0.2, 'Research Swarm Completed');
                    showToast('Research swarm completed! Click to view results.', 'success');
                } else if (swarm.status === 'processing') {
                    swarm.timeRemaining = Math.ceil((100 - swarm.progress) / 20) + ' min';
                }
                
                renderSwarms();
                
                if (swarm.status === 'completed') {
                    clearInterval(interval);
                }
            }, 2000);
        }

        function renderSwarms() {
            const container = document.getElementById('swarms-list');
            
            if (activeSwarms.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #718096; padding: 40px;">No active swarms. Launch your first research swarm above!</div>';
                return;
            }
            
            container.innerHTML = activeSwarms.map(swarm => `
                <div class="swarm-item" onclick="viewSwarmDetails(${swarm.id})">
                    <div class="swarm-query">${swarm.query}</div>
                    <div class="swarm-meta">
                        <span class="status-badge ${swarm.status}">${swarm.status.charAt(0).toUpperCase() + swarm.status.slice(1)}</span>
                        <span>${swarm.typeName}</span>
                        ${swarm.timeRemaining ? `<span>⏱ ${swarm.timeRemaining} remaining</span>` : ''}
                        ${swarm.status === 'completed' ? '<span style="color: #667eea; font-weight: 600;">📋 View Results</span>' : ''}
                        <span style="margin-left: auto;">${formatTimeAgo(swarm.timestamp)}</span>
                    </div>
                    ${swarm.status !== 'completed' ? `
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${swarm.progress}%"></div>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function updateStats() {
            document.getElementById('total-swarms').textContent = activeSwarms.length + 44; // Add base number
            document.getElementById('active-swarms').textContent = activeSwarms.filter(s => s.status === 'running' || s.status === 'processing').length;
        }

        function updateLaunchButton() {
            const query = document.getElementById('swarm-query').value.trim();
            const btn = document.getElementById('launch-btn');
            btn.disabled = !query;
        }

        function viewSwarmDetails(swarmId) {
            const swarm = activeSwarms.find(s => s.id === swarmId);
            if (!swarm) return;
            
            if (swarm.status === 'completed' && swarm.results) {
                showSwarmResults(swarm);
            } else {
                showToast(`Swarm is ${swarm.status}. Results will be available when completed.`, 'info');
            }
        }

        function showSwarmResults(swarm) {
            document.getElementById('modal-title').textContent = `Research Results: ${swarm.query}`;
            
            const modalBody = document.getElementById('modal-body');
            modalBody.innerHTML = `
                <div class="results-section">
                    <h3 class="results-title">🔍 Key Findings</h3>
                    ${swarm.results.keyFindings.map(finding => `
                        <div class="finding-item">${finding}</div>
                    `).join('')}
                </div>

                <div class="results-section">
                    <h3 class="results-title">💡 Strategic Recommendations</h3>
                    ${swarm.results.recommendations.map(rec => `
                        <div class="recommendation-item">
                            <div class="rec-header">
                                <h4 class="rec-title">${rec.action}</h4>
                                <span class="priority-tag priority-${rec.priority.toLowerCase()}">${rec.priority}</span>
                            </div>
                            <div class="rec-impact"><strong>Impact:</strong> ${rec.impact}</div>
                            <div class="rec-meta">
                                <span><strong>Timeline:</strong> ${rec.timeline}</span>
                                <span><strong>Effort:</strong> ${rec.effort}</span>
                                ${rec.revenue_impact ? `<span><strong>Revenue Impact:</strong> ${rec.revenue_impact}</span>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>

                <div class="results-section">
                    <h3 class="results-title">📚 Data Sources Analyzed</h3>
                    <ul style="padding-left: 20px;">
                        ${swarm.results.sources.map(source => `
                            <li style="margin-bottom: 6px; color: #4a5568; font-size: 14px;">${source}</li>
                        `).join('')}
                    </ul>
                </div>
            `;
            
            document.getElementById('results-modal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('results-modal').classList.remove('show');
        }

        // Template functions
        function populateTemplates() {
            const container = document.getElementById('templates-grid');
            container.innerHTML = swarmTemplates.map(template => `
                <div class="template-card" onclick="useTemplate('${template.query}', '${template.type}')">
                    <div class="template-icon">${template.icon}</div>
                    <div class="template-title">${template.title}</div>
                    <div class="template-desc">${template.description}</div>
                    <div class="template-example">Example: ${template.example}</div>
                </div>
            `).join('');
        }

        function useTemplate(query, type) {
            // Switch to dashboard
            switchSection('dashboard');
            
            // Set the query and type
            document.getElementById('swarm-query').value = query;
            selectSwarmType(type);
            updateLaunchButton();
            
            showToast('Template loaded! Review and launch your swarm.', 'success');
        }

        // Archive functions
        function populateArchive() {
            const container = document.getElementById('archive-results');
            const completedSwarms = activeSwarms.filter(s => s.status === 'completed');
            
            // Add some historical data
            const historicalSwarms = [
                {
                    id: 'hist-1',
                    query: 'Analyze Q3 2024 SaaS market consolidation trends',
                    type: 'market',
                    typeName: 'Market Research',
                    timestamp: Date.now() - 7 * 24 * 60 * 60 * 1000, // 7 days ago
                    summary: 'Major findings: 12 acquisitions, average 340% premium, focus on AI capabilities'
                },
                {
                    id: 'hist-2',
                    query: 'Competitive pricing analysis: Notion vs Airtable enterprise tiers',
                    type: 'competitive',
                    typeName: 'Competitive Analysis',
                    timestamp: Date.now() - 14 * 24 * 60 * 60 * 1000, // 14 days ago
                    summary: 'Pricing gap identified: 25% opportunity in mid-market segment'
                }
            ];
            
            const allArchive = [...completedSwarms, ...historicalSwarms];
            
            if (allArchive.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #718096; padding: 40px;">No completed research yet. Launch some swarms to build your archive!</div>';
                return;
            }
            
            container.innerHTML = allArchive.map(swarm => `
                <div class="swarm-item" onclick="viewArchiveItem('${swarm.id}')">
                    <div class="swarm-query">${swarm.query}</div>
                    <div class="swarm-meta">
                        <span class="status-badge completed">Completed</span>
                        <span>${swarm.typeName}</span>
                        <span style="margin-left: auto;">${formatTimeAgo(swarm.timestamp)}</span>
                    </div>
                    ${swarm.summary ? `<div style="font-size: 12px; color: #718096; margin-top: 8px;">${swarm.summary}</div>` : ''}
                </div>
            `).join('');
        }

        function setArchiveFilter(filter) {
            // Update filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            showToast(`Filter applied: ${filter}`, 'info');
            // Here you would implement actual filtering logic
        }

        function filterArchive() {
            showToast('Archive search functionality ready', 'info');
            // Implement search filtering here
        }

        function viewArchiveItem(itemId) {
            if (itemId.startsWith('hist-')) {
                showToast('Historical research details available in full version', 'info');
            } else {
                const swarm = activeSwarms.find(s => s.id == itemId);
                if (swarm && swarm.results) {
                    showSwarmResults(swarm);
                }
            }
        }

        // Competitive intelligence functions
        function populateCompetitive() {
            const container = document.getElementById('competitive-content');
            container.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div class="stats-card">
                        <h3 class="stats-title">🎯 Active Competitor Monitoring</h3>
                        <div style="font-size: 14px; color: #4a5568; line-height: 1.6;">
                            <div style="margin-bottom: 8px;">• <strong>Notion:</strong> New AI features launched</div>
                            <div style="margin-bottom: 8px;">• <strong>Airtable:</strong> Enterprise pricing increased 15%</div>
                            <div style="margin-bottom: 8px;">• <strong>Monday.com:</strong> Mobile app update released</div>
                            <div style="margin-bottom: 8px;">• <strong>Asana:</strong> Integration with Microsoft Teams</div>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <h3 class="stats-title">📊 Market Position Analysis</h3>
                        <div style="font-size: 14px; color: #4a5568;">
                            <div style="margin-bottom: 8px;"><strong>TaskFlow Market Share:</strong> 2.3%</div>
                            <div style="margin-bottom: 8px;"><strong>Growth Rate:</strong> +23% YoY</div>
                            <div style="margin-bottom: 8px;"><strong>Customer Satisfaction:</strong> 4.2/5</div>
                            <div style="margin-bottom: 8px;"><strong>Competitive Strength:</strong> Strong</div>
                        </div>
                    </div>
                </div>
                
                <div class="templates-grid">
                    <div class="template-card" onclick="launchCompetitiveSwarm('pricing')">
                        <div class="template-icon">💰</div>
                        <div class="template-title">Pricing Intelligence</div>
                        <div class="template-desc">Monitor competitor pricing changes and strategy shifts</div>
                    </div>
                    
                    <div class="template-card" onclick="launchCompetitiveSwarm('features')">
                        <div class="template-icon">⚡</div>
                        <div class="template-title">Feature Tracking</div>
                        <div class="template-desc">Track new feature launches and product updates</div>
                    </div>
                    
                    <div class="template-card" onclick="launchCompetitiveSwarm('marketing')">
                        <div class="template-icon">📢</div>
                        <div class="template-title">Marketing Strategy</div>
                        <div class="template-desc">Analyze competitor marketing campaigns and messaging</div>
                    </div>
                </div>
            `;
        }

        function launchCompetitiveSwarm(type) {
            const queries = {
                pricing: "Analyze recent pricing changes by Notion, Airtable, Monday.com, and Asana. Include enterprise tier adjustments, new pricing models, and customer reactions.",
                features: "Track new features launched by major project management competitors in the last 30 days. Focus on AI integrations, mobile updates, and enterprise capabilities.",
                marketing: "Research current marketing strategies of top PM tool competitors. Analyze messaging themes, ad spend patterns, and campaign effectiveness."
            };
            
            switchSection('dashboard');
            document.getElementById('swarm-query').value = queries[type];
            selectSwarmType('competitive');
            updateLaunchButton();
            
            showToast(`Competitive ${type} analysis ready to launch!`, 'success');
        }

        // Market trends functions
        function populateTrends() {
            const container = document.getElementById('trends-content');
            container.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                    <div>
                        <h3 style="margin-bottom: 16px; color: #2d3748;">📈 Current Market Trends</h3>
                        <div class="finding-item">AI integration becoming standard in PM tools (340% increase)</div>
                        <div class="finding-item">Remote work driving demand for mobile-first features</div>
                        <div class="finding-item">Enterprise customers demanding advanced security features</div>
                        <div class="finding-item">Integration ecosystem becoming key differentiator</div>
                        <div class="finding-item">Sustainability features requested in 67% of RFPs</div>
                    </div>
                    
                    <div>
                        <h3 style="margin-bottom: 16px; color: #2d3748;">🚀 Emerging Opportunities</h3>
                        <div class="recommendation-item">
                            <div class="rec-title">AI-Powered Project Health Scoring</div>
                            <div class="rec-impact">High demand, low competitor saturation</div>
                        </div>
                        <div class="recommendation-item">
                            <div class="rec-title">Industry-Specific Templates</div>
                            <div class="rec-impact">Manufacturing and healthcare showing strong interest</div>
                        </div>
                        <div class="recommendation-item">
                            <div class="rec-title">Carbon Footprint Tracking</div>
                            <div class="rec-impact">B-Corp certification driving enterprise demand</div>
                        </div>
                    </div>
                </div>
                
                <div class="templates-grid">
                    <div class="template-card" onclick="launchTrendSwarm('industry')">
                        <div class="template-icon">🏭</div>
                        <div class="template-title">Industry Analysis</div>
                        <div class="template-desc">Research specific industry adoption patterns and requirements</div>
                    </div>
                    
                    <div class="template-card" onclick="launchTrendSwarm('technology')">
                        <div class="template-icon">🔬</div>
                        <div class="template-title">Technology Trends</div>
                        <div class="template-desc">Track emerging technologies impacting project management</div>
                    </div>
                    
                    <div class="template-card" onclick="launchTrendSwarm('forecast')">
                        <div class="template-icon">🔮</div>
                        <div class="template-title">Market Forecast</div>
                        <div class="template-desc">Generate predictions for market evolution and opportunities</div>
                    </div>
                </div>
            `;
        }

        function launchTrendSwarm(type) {
            const queries = {
                industry: "Research which industries are adopting project management tools fastest in 2024-2025. Analyze specific requirements, budget ranges, and growth patterns.",
                technology: "Identify emerging technologies (AI, blockchain, IoT) that will impact project management software in the next 2-3 years. Include adoption timelines and implementation strategies.",
                forecast: "Create a comprehensive market forecast for the project management software industry through 2027. Include growth projections, disruption risks, and strategic recommendations."
            };
            
            switchSection('dashboard');
            document.getElementById('swarm-query').value = queries[type];
            selectSwarmType('market');
            updateLaunchButton();
            
            showToast(`Market ${type} research ready to launch!`, 'success');
        }

        // Settings functions
        function populateSettings() {
            const container = document.getElementById('settings-content');
            container.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <div class="stats-card">
                            <h3 class="stats-title">🔧 Swarm Configuration</h3>
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Research Depth:</label>
                                <select style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                                    <option>Standard (5-10 sources)</option>
                                    <option>Deep (15-25 sources)</option>
                                    <option>Comprehensive (30+ sources)</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Analysis Speed:</label>
                                <select style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                                    <option>Fast (2-3 minutes)</option>
                                    <option>Balanced (5-7 minutes)</option>
                                    <option>Thorough (10-15 minutes)</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Result Format:</label>
                                <select style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                                    <option>Executive Summary</option>
                                    <option>Detailed Analysis</option>
                                    <option>Action-Oriented</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="stats-card" style="margin-top: 20px;">
                            <h3 class="stats-title">📊 Data Sources</h3>
                            <div style="font-size: 14px;">
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" checked style="margin-right: 8px;"> Customer reviews
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" style="margin-right: 8px;"> Financial reports (Premium)
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" style="margin-right: 8px;"> Patent databases (Premium)
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="stats-card">
                            <h3 class="stats-title">🔔 Notifications</h3>
                            <div style="font-size: 14px;">
                                <label style="display: flex; align-items: center; margin-bottom: 12px;">
                                    <input type="checkbox" checked style="margin-right: 8px;"> Email when swarm completes
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 12px;">
                                    <input type="checkbox" checked style="margin-right: 8px;"> Push notifications
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 12px;">
                                    <input type="checkbox" style="margin-right: 8px;"> Weekly digest
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 12px;">
                                    <input type="checkbox" style="margin-right: 8px;"> Slack integration
                                </label>
                            </div>
                        </div>
                        
                        <div class="stats-card" style="margin-top: 20px;">
                            <h3 class="stats-title">🎯 Focus Areas</h3>
                            <div style="font-size: 14px;">
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" checked style="margin-right: 8px;"> SaaS & Technology
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" checked style="margin-right: 8px;"> Project Management
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" style="margin-right: 8px;"> Enterprise Software
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" style="margin-right: 8px;"> AI & Automation
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" style="margin-right: 8px;"> Remote Work Tools
                                </label>
                            </div>
                        </div>
                        
                        <button class="launch-btn" style="margin-top: 20px;" onclick="saveSettings()">
                            💾 Save Configuration
                        </button>
                    </div>
                </div>
            `;
        }

        function saveSettings() {
            showToast('Configuration saved successfully!', 'success');
        }

        // Utility functions
        function formatTimeAgo(timestamp) {
            const diff = Date.now() - timestamp;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);
            
            if (days > 0) return `${days}d ago`;
            if (hours > 0) return `${hours}h ago`;
            return `${minutes}m ago`;
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize the page
            renderSwarms();
            updateStats();
            
            // Add input listener for launch button
            document.getElementById('swarm-query').addEventListener('input', updateLaunchButton);
            
            // Show welcome message
            setTimeout(() => {
                showToast('Research Swarms system ready!', 'success');
            }, 1000);
        });

        // Listen for messages from parent portal
        window.addEventListener('message', function(event) {
            if (event.data.type === 'refresh-swarms') {
                renderSwarms();
                updateStats();
            }
        });

        // Simulate real-time updates for active swarms
        setInterval(() => {
            const runningSwarms = activeSwarms.filter(s => s.status === 'running' || s.status === 'processing');
            if (runningSwarms.length > 0 && Math.random() < 0.3) {
                renderSwarms();
            }
        }, 5000);

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case '1':
                        e.preventDefault();
                        switchSection('dashboard');
                        break;
                    case '2':
                        e.preventDefault();
                        switchSection('templates');
                        break;
                    case '3':
                        e.preventDefault();
                        switchSection('archive');
                        break;
                    case 'Enter':
                        e.preventDefault();
                        const query = document.getElementById('swarm-query').value.trim();
                        if (query && document.querySelector('.section.active').id === 'dashboard-section') {
                            launchSwarm();
                        }
                        break;
                }
            }
        });

        // Close modal on outside click
        document.getElementById('results-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Performance monitoring
        window.performance.mark('research-swarms-loaded');
        
        // Export functions for debugging
        window.ResearchSwarms = {
            activeSwarms,
            switchSection,
            launchSwarm,
            showToast
        };
    </script>
</body>
</html> Competitor websites
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" checked style="margin-right: 8px;"> Social media analysis
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" checked style="margin-right: 8px;"> Industry reports
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <input type="checkbox" checked style="margin-right: 8px;">
